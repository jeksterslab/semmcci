\documentclass{article}

\input{latex/preamble/preamble}

%% begin.rcode
% #| label = "root",
% #| include = FALSE
% root <- rprojroot::is_rstudio_project
%% end.rcode

%% begin.rcode
% #| label = "knitr",
% #| include = FALSE,
% #| file = root$find_file(
% #|   "latex",
% #|   "r-scripts",
% #|   "knitr.R"
% #| )
%% end.rcode

%% begin.rcode
% #| label = "biblatex",
% #| echo = FALSE,
% #| warning = FALSE,
% #| results = "asis"
% cat(
%   .PreambleBiblatexCombined(
%     path = root$find_file(
%       "latex",
%       "bib"
%     ),
%     output_path = root$find_file(
%       "latex"
%     )
%   )
% )
%% end.rcode

\renewcommand{\baselinestretch}{1}

\title{semmcci: Staging}
\author{Ivan Jacob Agaloos Pesigan}
\date{}

\begin{document}

\maketitle

\section{Observed Variables}

%% begin.rcode
% #| echo = FALSE
% ## ---- test-semmcci-mc-simple-med-std-defined
%   n <- 1000L
%     seed <- sample.int(
%       n = .Machine$integer.max,
%       size = 1
%     )
%     coefs <- stats::runif(
%       n = 3,
%       min = 0.0,
%       max = 0.5
%     )
%     cp <- coefs[1]
%     b <- coefs[2]
%     a <- coefs[3]
%     sigma2ey <- 1 - b^2 - cp^2 - 2 * a * b * cp
%     sigma2em <- 1 - a^2
%     sigma2x <- 1
%     coefs <- c(
%       cp = cp,
%       b = b,
%       a = a,
%       ab = a * b
%     )
%     x <- rnorm(n = n, sd = sqrt(sigma2x))
%     m <- a * x + rnorm(n = n, sd = sqrt(sigma2em))
%     y <- cp * x + b * m + rnorm(n = n, sd = sqrt(sigma2ey))
%     data <- data.frame(x, m, y)
%     model <- "
%       y ~ cp * x + b * m
%       m ~ a * x
%       ab := a * b
%     "
%     fit <- lavaan::sem(
%       data = data,
%       model = model,
%       fixed.x = FALSE
%     )
%     set.seed(seed)
%     results_unstd <- mc(
%       fit,
%       R = 10L,
%       alpha = c(0.001, 0.01, 0.05)
%     )
%     results_mat <- mc_std(results_unstd)
%     results_lav <- mc_std_lav(results_unstd)
%% end.rcode

%% begin.rcode
%  results_mat
%  results_lav
%  all.equal(results_mat$ci, results_lav$ci)
%% end.rcode

\newpage

\section{Latent Variables}

%% begin.rcode
% #| echo = FALSE
% ## ---- test-semmcci-mc-latent-med-defined
%     n <- 1000L
%     seed <- sample.int(
%       n = .Machine$integer.max,
%       size = 1
%     )
%     data <- lavaan::HolzingerSwineford1939
%     model <- "
%       visual  =~ x1 + x2 + x3
%       textual =~ x4 + x5 + x6
%       speed   =~ x7 + x8 + x9
%       textual ~ a * visual
%       speed ~ b * textual
%       ab := a * b
%     "
%     fit <- lavaan::sem(
%       model = model,
%       data = data
%     )
%     set.seed(seed)
%     results_unstd <- mc(
%       fit,
%       R = 10L,
%       alpha = c(0.001, 0.01, 0.05)
%     )
%     results_mat <- mc_std(results_unstd)
%     results_lav <- mc_std_lav(results_unstd)
%% end.rcode

%% begin.rcode
%  results_mat
%  results_lav
%  all.equal(results_mat$ci.std, results_lav$ci.std)
%% end.rcode

\nocite{Lib-R-Manual-2022}

\printbibliography

\end{document}
